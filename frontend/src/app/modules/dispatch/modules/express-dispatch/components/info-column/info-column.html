<template>

    <require from="./info-column.scss"></require>

    <page-content scroll scroll.ref="scroll">

        <page-header scroll-fade>

            <h1 class="font-largest">
                <path-nav>

                    <a accent="inherit" href="/dispatch" translate>
                        Dispatch
                    </a>

                    <a accent="inherit" click.trigger="onBackClick()" href="#" translate>
                        Express dispatch
                    </a>

                    <span if.bind="workspace.selectedExpressRoutes.length > 0" translate>
                        Add stops to driver
                    </span>

                    <span if.bind="workspace.selectedExpressRoutes.length == 0" translate>
                        Modify driver route
                    </span>

                </path-nav>
            </h1>

        </page-header>

        <page-section>

            <h2 class="font-larger margin-larger-bottom" translate>
                Selected driver
            </h2>

            <data-table appearance="rows" class="selected-driver-table --reduce-header-whitespace">

                <data-table-headers>

                    <data-table-cell title.translate="Status">
                        <span class="text-truncate" translate>
                            Status
                        </span>
                    </data-table-cell>

                    <data-table-cell title.translate="Online">
                        <span class="text-truncate" translate>
                            Online/Offline
                        </span>
                    </data-table-cell>

                    <data-table-cell title.translate="ID">
                        <span class="text-truncate" translate>
                            Id
                        </span>
                    </data-table-cell>

                    <data-table-cell title.translate="Name">
                        <span class="text-truncate" translate>
                            Name
                        </span>
                    </data-table-cell>

                    <data-table-cell title.translate="Vehicle">
                        <span class="text-truncate" translate>
                            Vehicle
                        </span>
                    </data-table-cell>

                    <data-table-cell title.translate="Done">
                        <span class="text-truncate" translate>
                            Done
                        </span>
                    </data-table-cell>

                    <data-table-cell title.translate="Last stop address">
                        <span class="text-truncate" translate>
                            Last stop address
                        </span>
                    </data-table-cell>

                </data-table-headers>

                <template repeat.for="item of workspace.selectedDriverRoutes">

                    <data-table-row accent.bind="item.criticality.accent">

                        <data-table-cell title.bind="item.status.name" accent.bind="item.status.accent & attr">
                            <icon name="md-warning" if.bind="item.status.accent == 'attention' || item.status.accent == 'negative'"></icon>
                            <span class="text-truncate">
                                ${item.status.name}
                            </span>
                        </data-table-cell>

                        <data-table-cell title.bind="item.slug" accent.bind="!item.driverOnline ? 'negative' : 'neutral' & attr">
                            <icon name="md-warning" if.bind="!item.driverOnline"></icon>
                            <span class="text-truncate">
                                <template if.bind="item.driverOnline" translate>
                                    Online
                                </template>
                                <template if.bind="!item.driverOnline" translate>
                                    Offline
                                </template>
                            </span>
                        </data-table-cell>

                        <data-table-cell title.bind="item.slug">
                            <a class="text-truncate" href="/fleet-management/drivers/details/${item.driver.id}">
                                ${item.driver.id}
                            </a>
                        </data-table-cell>

                        <data-table-cell title.bind="item.driver.name">
                            <span class="text-truncate" empty-value>
                                ${item.driver.name}
                            </span>
                        </data-table-cell>

                        <data-table-cell title.bind="item.vehicle.vehicleType.name">
                            <span class="text-truncate" empty-value>
                                ${item.vehicle.type.name}
                            </span>
                        </data-table-cell>

                        <data-table-cell title.bind="item.completionTime">
                            <span class="text-truncate" empty-value>
                                ${item.completionTime | time: 'narrow' : false}
                            </span>
                        </data-table-cell>

                        <data-table-cell title.bind="item.lastStop.location.address">
                            <span class="text-truncate" empty-value>
                                ${item.lastStop.location.address}
                            </span>
                        </data-table-cell>

                    </data-table-row>

                </template>

            </data-table>

        </page-section>

        <page-section if.bind="workspace.selectedExpressRoutes.length > 0">

            <h2 class="font-larger margin-larger-bottom" translate>
                Selected routes
            </h2>

            <data-table appearance="rows" class="selected-routes-table --reduce-header-whitespace">

                <data-table-headers>

                    <data-table-cell title.translate="Time remaining">
                        <span class="text-truncate" translate>
                            Time remaining
                        </span>
                    </data-table-cell>

                    <data-table-cell title.translate="Consignor">
                        <span class="text-truncate" translate>
                            Consignor
                        </span>
                    </data-table-cell>

                    <data-table-cell title.translate="Vehicle">
                        <span class="text-truncate" translate>
                            Vehicle
                        </span>
                    </data-table-cell>

                    <data-table-cell title.translate="Weight" name="totalWeightRange">
                        <span class="text-truncate" translate>
                            Weight
                        </span>
                    </data-table-cell>

                    <data-table-cell title.translate="Pickup address">
                        <span class="text-truncate" translate>
                            Pickup address
                        </span>
                    </data-table-cell>

                    <data-table-cell>
                        <span class="text-truncate" translate>
                            Zip
                        </span>
                    </data-table-cell>

                    <data-table-cell>
                        <span class="text-truncate" translate>
                            Timeframe
                        </span>
                    </data-table-cell>

                    <data-table-cell title.translate="Delivery address">
                        <span class="text-truncate" translate>
                            Delivery address
                        </span>
                    </data-table-cell>

                    <data-table-cell>
                        <span class="text-truncate" translate>
                            Zip
                        </span>
                    </data-table-cell>

                    <data-table-cell>
                        <span class="text-truncate" translate>
                            Timeframe
                        </span>
                    </data-table-cell>

                    <data-table-cell>
                        <span class="text-truncate" translate>
                            Details
                        </span>
                    </data-table-cell>

                    <!--<data-table-cell align="right">
                    </data-table-cell>-->

                </data-table-headers>

                <template repeat.for="item of workspace.selectedExpressRoutes">

                    <data-table-row accent.bind="item.selected ? item.colorIndex : undefined">

                        <data-table-cell title.bind="item.timeToDeadline | duration" accent.bind="item.criticality.accent & attr">
                            <icon name="md-warning" if.bind="item.criticality.accent == 'attention' || item.criticality.accent == 'negative'"></icon>
                            <span class="text-truncate">
                                ${item.timeToDeadline | duration }
                            </span>
                        </data-table-cell>

                        <data-table-cell title.bind="item.consignor.primaryName">
                            <span class="text-truncate">
                                ${item.consignor.primaryName}
                            </span>
                        </data-table-cell>

                        <data-table-cell title.bind="item.vehicleType.name">
                            <span class="text-truncate">
                                ${item.vehicleType.name}
                            </span>
                        </data-table-cell>

                        <data-table-cell title="${item.totalWeightRange.from | number} – ${item.totalWeightRange.to | number} kg">
                            <span if.bind="item.totalWeightRange != null" class="text-truncate">
                                ${item.totalWeightRange.from | number} – ${item.totalWeightRange.to | number} kg
                            </span>
                        </data-table-cell>

                        <data-table-cell title.bind="item.pickupLocation.address">
                            <span class="text-truncate">
                                ${item.pickupLocation.address}
                            </span>
                        </data-table-cell>

                        <data-table-cell>
                            <span class="text-truncate">
                                ${item.stops[0].location.address.zipCode}
                            </span>
                        </data-table-cell>

                        <data-table-cell>
                            <span class="text-truncate">
                                ${item.stops[0].arrivalTimeFrame | timeRange: false}
                            </span>
                        </data-table-cell>

                        <data-table-cell title.bind="item.deliveryLocation.address">
                            <span class="text-truncate">
                                ${item.deliveryLocation.address}
                            </span>
                        </data-table-cell>

                        <data-table-cell>
                            <span class="text-truncate">
                                ${item.stops[item.stops.length-1].location.address.zipCode}
                            </span>
                        </data-table-cell>

                        <data-table-cell>
                            <span class="text-truncate">
                                ${item.stops[item.stops.length-1].arrivalTimeFrame | timeRange: false}
                            </span>
                        </data-table-cell>

                        <data-table-cell title.bind="item.slug">
                            <a href="/routes/details/${item.slug}" class="text-truncate" translate>
                                Details
                            </a>
                        </data-table-cell>

                        <!--<data-table-cell align="right">

                            <div class="icon-row">

                                <button appearance="none" accent="primary" click.trigger="onRemoveRouteClick(item)">
                                    <icon name="delete-small"></icon>
                                </button>

                            </div>

                        </data-table-cell>-->

                    </data-table-row>

                </template>

            </data-table>

        </page-section>

    </page-content>

</template>
