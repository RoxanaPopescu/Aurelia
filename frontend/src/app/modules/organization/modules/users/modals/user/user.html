<template>

    <require from="app/components/star-icon/star-icon"></require>
    <require from="./components/profile-pane/profile-pane"></require>
    <require from="./components/security-pane/security-pane"></require>

    <require from="./user.scss"></require>

    <modal-backdrop close="top"></modal-backdrop>

    <modal-panel name="user" position="right" close-button.bind="true" close-shortcut.bind="true" validation validation.ref="validation" scroll>

        <div slot="actions">

            <button
                if.bind="!readonly && user.status.slug !== 'invited'"
                appearance="icon"
                title.translate="Save changes"
                click.trigger="onSaveClick()"
                disabled.bind="!hasChanges">
                <icon name="ico-save"></icon>
            </button>

        </div>

        <modal-header scroll-fade>

            <h1 class="font-largest user-select-contain">
                <template if.bind="user.status.slug === 'invited'" translate>
                    Invite
                </template>
                <template else translate>
                    ${user.fullName}
                </template>
                <star-icon entity.bind="role"></star-icon>
            </h1>

            <tab-nav if.bind="!readonly && user.status.slug !== 'invited'" appearance="tabs" class="margin-top font-large" value.bind="selectedTab">

                <tab name="profile">
                    <h2 translate>
                        Profile
                    </h2>
                </tab>

                <tab name="security">
                    <h2 translate>
                        Security
                    </h2>
                </tab>

            </tab-nav>

        </modal-header>

        <profile-pane
            show.bind="selectedTab === 'profile'"
            user.bind="user"
            available-teams.bind="availableTeams"
            selected-teams.bind="selectedTeams"
            available-roles.bind="availableRoles"
            selected-role.bind="selectedRole"
            readonly.bind="readonly"
            can-change-role.bind="canChangeRole"
            can-change-team.bind="canChangeTeam"
            validation.ref="profileValidation">
        </profile-pane>

        <security-pane
            show.bind="selectedTab === 'security'"
            user.bind="user"
            validation.ref="securityValidation">
        </security-pane>

    </modal-panel>

</template>
