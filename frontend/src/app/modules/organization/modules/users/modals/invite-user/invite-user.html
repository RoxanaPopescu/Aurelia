<template>

    <require from="app/components/address-input/address-input"></require>

    <modal-backdrop close="all"></modal-backdrop>

    <modal-panel name="invite-user" position="right" close-button.bind="true" close-shortcut.bind="true" scroll validation validation.ref="validation">

        <modal-header scroll-fade>

            <h1 class="font-largest margin-bottom" tabindex="-1" autofocus="visible.bind: false" translate>
                Invite user
            </h1>

            <h2 class="font-large" translate>
                An email will be sent to the user, inviting them<br>
                to join the organization.
            </h2>

        </modal-header>

        <modal-section class="margin-bottom">

            <div class="control-row margin-large-bottom">

                <email-input value.bind="invite.email" label="above" class="flex-basis-1-of-1">

                    <div slot="heading" translate>
                        Email addresse
                    </div>

                    <div slot="description" translate>
                        This is the email to which the invite will be sent.
                    </div>

                    <div slot="validation">

                        <required-validator
                            value.bind="invite.email">
                        </required-validator>

                        <custom-validator
                            valid.bind="!invite.email || !unavailableEmailAddresses.includes(invite.email)">

                            <template replace-part="invalid" translate>
                                The organization already has a user with the specified email address.
                            </template>

                        </custom-validator>

                    </div>

                </email-input>

            </div>

            <div class="control-row margin-large-bottom">

                <select-input label="above" none.bind="false" value.bind="selectedRole" display-value.bind="selectedRole.name" class="flex-basis-1-of-1">

                    <div slot="heading" translate>
                        Role
                    </div>

                    <div slot="description" translate>
                        This is the role that will be assigned to the user within the organization.
                    </div>

                    <item repeat.for="role of availableRoles" model.bind="role">
                        ${role.name}
                    </item>

                    <div slot="validation">

                        <required-validator
                            value.bind="selectedRole">
                        </required-validator>

                    </div>

                </select-input>

            </div>

            <div if-claims="view-teams" class="control-row margin-large-bottom">

                <tags-input label="above" value.bind="selectedTeams" class="flex-basis-1-of-1">

                    <div slot="heading" translate>
                        Teams
                    </div>

                    <div slot="description" translate>
                        This is the team to which the user will be assigned.
                    </div>

                    <div slot="value">
                        <tag repeat.for="team of selectedTeams" model.bind="team">
                            ${team.name}
                        </tag>
                    </div>

                    <item repeat.for="team of availableTeams" model.bind="team">
                        ${team.name}
                    </item>

                </tags-input>

            </div>

            <div class="control-row">

                <text-input value.bind="invite.message" label="above" lines="5" class="flex-basis-1-of-1">

                    <div slot="heading" translate>
                        Message
                    </div>

                    <div slot="description" translate>
                        This is a message that will be included in the invite sent to the user.
                    </div>

                </text-input>

            </div>

        </modal-section>

        <button appearance="solid" accent="primary" class="margin-large-top" click.delegate="onSubmitClick()" translate>
            Send invite
        </button>

    </modal-panel>

</template>
