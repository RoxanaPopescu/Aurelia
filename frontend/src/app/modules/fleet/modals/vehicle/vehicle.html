<template>

    <require from="./vehicle.scss"></require>

    <modal-backdrop close="all"></modal-backdrop>

    <modal-panel name="vehicle" position="right" close-button.bind="true" close-shortcut.bind="true" scroll validation validation.ref="validation">

        <modal-header scroll-fade>

            <h1 class="font-largest">

                <template if.bind="vehicle.id != null" translate>
                    Edit vehicle
                </template>

                <template if.bind="vehicle.id == null" translate>
                    New vehicle
                </template>

            </h1>

        </modal-header>

        <modal-section class="margin-larger-bottom">

            <div if.bind="vehicle.id" class="control-row margin-larger-bottom">
                <text-input readonly="true" label="above" value.bind="vehicle.id" class="flex-basis-1-of-1">

                    <div slot="heading" translate>
                        Id
                    </div>

                </text-input>
            </div>

            <div class="control-row">

                <text-input label="above" value.bind="vehicle.name" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Name
                    </div>

                    <div slot="validation">

                        <required-validator
                            value.bind="vehicle.name">
                        </required-validator>

                    </div>

                </text-input>

                <select-input label="above" none.bind="false" value.bind="vehicle.status" display-value.bind="vehicle.status.name" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Status
                    </div>

                    <item repeat.for="status of statuses" model.bind="status">
                        ${status.name}
                    </item>

                    <div slot="validation">

                        <required-validator
                            value.bind="vehicle.status">
                        </required-validator>

                    </div>

                </select-input>
            </div>

        </modal-section>

        <hr class="hr-line margin-large-bottom">

        <modal-section class="margin-larger-bottom">

            <div slot="header" translate>
                Vehicle information
            </div>

            <div class="control-row margin-larger-bottom">

                <select-input label="above" none.bind="false" value.bind="vehicle.type" display-value.bind="vehicle.type.name" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Type
                    </div>

                    <item repeat.for="vehicleType of vehicleTypes" model.bind="vehicleType">
                        ${vehicleType.name}
                    </item>

                    <div slot="validation">

                        <required-validator
                            value.bind="vehicle.type">
                        </required-validator>

                    </div>

                </select-input>

                <text-input label="above" value.bind="vehicle.licensePlate" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Registration number
                    </div>

                    <div slot="validation">

                        <required-validator
                            value.bind="vehicle.licensePlate">
                        </required-validator>

                    </div>

                </text-input>

            </div>

            <div class="control-row margin-larger-bottom">

                <text-input label="above" value.bind="vehicle.model" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Model
                    </div>

                    <div slot="validation">

                        <required-validator
                            value.bind="vehicle.model">
                        </required-validator>

                    </div>

                </text-input>

                <text-input label="above" value.bind="vehicle.make" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Make
                    </div>

                    <div slot="validation">

                        <required-validator
                            value.bind="vehicle.make">
                        </required-validator>

                    </div>

                </text-input>

            </div>

            <div class="control-row">

                <number-input label="above" value.bind="vehicle.productionYear" min.bind="0" use-grouping.bind="false" constrain.bind="true" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Production year
                    </div>

                    <div slot="validation">

                        <required-validator
                            value.bind="vehicle.productionYear">
                        </required-validator>

                        <length-validator
                            value.bind="vehicle.productionYear"
                            min.bind="4"
                            max.bind="4">
                        </length-validator>

                    </div>

                </number-input>

                <text-input label="above" value.bind="vehicle.color" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Color
                    </div>

                    <div slot="validation">

                        <required-validator
                            value.bind="vehicle.color">
                        </required-validator>

                    </div>

                </text-input>

            </div>

        </modal-section>

        <hr class="hr-line margin-large-bottom">

        <modal-section class="margin-larger-bottom">

            <div slot="header" translate>
                Weight and inner dimensions
            </div>

            <div class="control-row margin-larger-bottom">

                <number-input label="above" value.bind="vehicle.approvedTotalWeight" min.bind="0" constrain.bind="true" class="flex-basis-1-of-3">

                    <div slot="heading" translate>
                        Approved total weight
                    </div>

                    <span slot="after" class="opacity-faded">
                        kg
                    </span>

                    <div slot="validation">

                        <required-validator
                            value.bind="vehicle.approvedTotalWeight">
                        </required-validator>

                        <range-validator
                            value.bind="vehicle.approvedTotalWeight"
                            min.bind="0"
                            min-inclusive.bind="false">
                        </range-validator>

                    </div>

                </number-input>

                <div class="flex-basis-1-of-3"></div>

                <div class="flex-basis-1-of-3"></div>

            </div>

            <div class="control-row">

                <number-input
                    label="above"
                    value.bind="vehicle.internalDimensions.height"
                    min.bind="0"
                    constrain.bind="true"
                    class="flex-basis-1-of-3">

                    <div slot="heading" translate>
                        Height
                    </div>

                    <span slot="after" class="opacity-faded">
                        meters
                    </span>

                    <div slot="validation">

                        <required-validator
                            value.bind="vehicle.internalDimensions.height"
                            enabled.bind="(vehicle.internalDimensions.height || vehicle.internalDimensions.width || vehicle.internalDimensions.length) ? undefined : false">
                        </required-validator>

                        <range-validator
                            active.bind="true"
                            value.bind="vehicle.internalDimensions.height"
                            min.bind="0"
                            min-inclusive.bind="false">
                        </range-validator>

                    </div>

                </number-input>

                <number-input
                    label="above"
                    value.bind="vehicle.internalDimensions.width"
                    min.bind="0"
                    constrain.bind="true"
                    class="flex-basis-1-of-3">

                    <div slot="heading" translate>
                        Width
                    </div>

                    <span slot="after" class="opacity-faded">
                        meters
                    </span>

                    <div slot="validation">

                        <required-validator
                            value.bind="vehicle.internalDimensions.width"
                            enabled.bind="(vehicle.internalDimensions.height || vehicle.internalDimensions.width || vehicle.internalDimensions.length) ? undefined : false">
                        </required-validator>

                        <range-validator
                            active.bind="true"
                            value.bind="vehicle.internalDimensions.width"
                            min.bind="0"
                            min-inclusive.bind="false">
                        </range-validator>

                    </div>

                </number-input>

                <number-input label="above" value.bind="vehicle.internalDimensions.length" min.bind="0" constrain.bind="true" class="flex-basis-1-of-3">

                    <div slot="heading" translate>
                        Length
                    </div>

                    <span slot="after" class="opacity-faded">
                        meters
                    </span>

                    <div slot="validation">

                        <required-validator
                            value.bind="vehicle.internalDimensions.length"
                            enabled.bind="(vehicle.internalDimensions.height || vehicle.internalDimensions.width || vehicle.internalDimensions.length) ? undefined : false">
                        </required-validator>

                        <range-validator
                            active.bind="true"
                            value.bind="vehicle.internalDimensions.length"
                            min.bind="0"
                            min-inclusive.bind="false">
                        </range-validator>

                    </div>

                </number-input>

            </div>

        </modal-section>

        <div class="button-container margin-large-top">

            <button appearance="outline" accent="primary" click.trigger="onCancel()" translate>
                Cancel
            </button>

            <button if.bind="vehicle.id == null" appearance="solid" accent="primary" click.trigger="onSaveOrCreateClick()" translate>
                Create vehicle
            </button>

            <button if.bind="vehicle.id != null" appearance="solid" accent="primary" click.trigger="onSaveOrCreateClick()" translate>
                Save changes
            </button>

        </div>

    </modal-panel>

</template>
