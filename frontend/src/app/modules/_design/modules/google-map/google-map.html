<template>

    <require from="./google-map.scss"></require>
    <require from="./components/custom-map-marker/custom-map-marker"></require>

    <page name="google-map">

        <toolbar>

            <let
                show-map.bind="true"
                show-line.bind="true"
                show-area.bind="true"
                show-markers.bind="true"
                show-drawing.bind="false">
            </let>

            <button appearance="solid" click.trigger="showMap = !showMap">
                Map: ${showMap}
            </button>

            <button appearance="solid" click.trigger="showLine = !showLine">
                Line in view: ${showLine}
            </button>

            <button appearance="solid" click.trigger="showArea = !showArea">
                Area in view: ${showArea}
            </button>

            <button appearance="solid" click.trigger="showMarkers = !showMarkers">
                Markers in view: ${showMarkers}
            </button>

            <button if.bind="markersAdded.length == 0" appearance="solid" click.trigger="addMarkers()">
                Markers in code: false
            </button>

            <button if.bind="markersAdded.length > 0" appearance="solid" click.trigger="removeMarkers()">
                Markers in code: true
            </button>

            <button appearance="solid" click.trigger="showDrawing = !showDrawing">
                Drawing: ${showDrawing}
            </button>

        </toolbar>

        <template if.bind="showMap">

            <google-map
                configure.call="onMapConfigure(options)"
                configured.call="onMapConfigured(map)"
                touched.bind="mapTouched"
                type.bind="mapType"
                view-model.ref="mapViewModel">

                <google-map-marker
                    point.bind="centerMarker.point"
                    title.bind="centerMarker.title"
                    z-index.bind="centerMarker.zIndex">

                    <google-map-popover pinned.one-time="true">
                        Popover for marker
                    </google-map-popover>

                </google-map-marker>

                <template if.bind="showLine">

                    <google-map-line
                        points.bind="markers | map: 'point'"
                        stroke-color="--palette-color-positive"
                        stroke-width="5">

                        <google-map-popover>
                            Popover for line
                        </google-map-popover>

                    </google-map-line>

                </template>

                <template if.bind="showArea">

                    <google-map-area
                        area.bind="area"
                        fill-color="--palette-color-positive"
                        stroke-color="--palette-color-positive"
                        stroke-width="1">

                        <google-map-popover>
                            Popover for area
                        </google-map-popover>

                    </google-map-area>

                </template>

                <template if.bind="showMarkers">

                    <custom-map-marker
                        repeat.for="marker of markers"
                        model.bind="marker">
                    </custom-map-marker>

                </template>

                <template if.bind="showDrawing">

                    <google-map-drawing
                        stroke-color="--google-map-feature-color--primary"
                        stroke-width="3"
                        fill-color="--google-map-feature-color--primary"
                        z-index.bind="1000"
                        complete.call="onDrawingComplete(polygon)">
                    </google-map-drawing>

                    <google-map-area
                        if.bind="drawnPolygon != null"
                        area.bind="drawnPolygon"
                        fill-color="--google-map-feature-color--info"
                        stroke-color="--google-map-feature-color--info">
                    </google-map-area>

                </template>

            </google-map>

        </template>

    </page>

</template>
