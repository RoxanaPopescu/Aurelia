<template>

    <require from="app/components/address-input/address-input"></require>

    <require from="./vehicle-group-edit.scss"></require>

    <modal-backdrop close="all"></modal-backdrop>

    <modal-panel name="vehicle-group-edit" position="right" close-button.bind="true" close-shortcut.bind="true" scroll validation validation.ref="validation">

        <div slot="actions">

            <button
                if.bind="!isNew"
                appearance="icon"
                title.translate="Save changes"
                click.trigger="onSaveClick()">
                <icon name="save"></icon>
            </button>

        </div>

        <modal-header scroll-fade>

            <h1 class="font-largest" tabindex="-1" autofocus="visible.bind: false">

                <span if.bind="isNew" translate>
                    Create vehicle rule
                </span>

                <span if.bind="!isNew" translate>
                    Edit vehicle rule
                </span>

            </h1>

        </modal-header>

        <modal-section>

            <div class="control-row">

                <text-input
                    label="above"
                    value.bind="model.name"
                    class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Name of the rule
                    </div>

                </text-input>

                <select-input
                    label="above"
                    none.bind="false"
                    value.bind="model.vehicleType"
                    display-value.bind="model.vehicleType.name"
                    class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Vehicle type
                    </div>

                    <item repeat.for="vehicleType of vehicleTypes" model.bind="vehicleType">
                        ${vehicleType.name}
                    </item>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.vehicleType">
                        </required-validator>

                    </div>

                </select-input>

            </div>

        </modal-section>

        <modal-section class="--line-above">

            <div slot="header" translate>
                Cost
            </div>

            <h1 class="margin-large-bottom" translate>
                Here you can specify the cost associated with this vehicle group.
            </h1>

            <div class="control-row margin-larger-bottom">

                <number-input
                    value.bind="model.cost.newRoute"
                    label="above"
                    class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Cost of a new route
                    </div>

                    <span slot="after" class="opacity-faded">
                        per route
                    </span>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.cost.newRoute">
                        </required-validator>

                    </div>

                </number-input>

                <number-input
                    value.bind="model.cost.waitingTime"
                    label="above"
                    class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Cost of waiting time
                    </div>

                    <span slot="after" class="opacity-faded">
                        per min
                    </span>


                    <div slot="validation">

                        <required-validator
                            value.bind="model.cost.waitingTime">
                        </required-validator>

                    </div>

                </number-input>

            </div>

            <div class="control-row margin-larger-bottom">

                <number-input
                    value.bind="model.cost.drivingTime"
                    label="above"
                    class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Cost of driving time
                    </div>

                    <span slot="after" class="opacity-faded">
                        per min
                    </span>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.cost.drivingTime">
                        </required-validator>

                    </div>

                </number-input>

                <number-input
                    value.bind="model.cost.taskTime"
                    label="above"
                    class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Cost of task time
                    </div>

                    <span slot="after" class="opacity-faded">
                        per min
                    </span>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.cost.taskTime">
                        </required-validator>

                    </div>

                </number-input>

            </div>

            <div class="control-row">

                <number-input
                    value.bind="model.cost.distance"
                    label="above"
                    class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Cost of distance driven
                    </div>

                    <span slot="after" class="opacity-faded">
                        per km
                    </span>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.cost.distance">
                        </required-validator>

                    </div>

                </number-input>

            </div>

        </modal-section>

        <modal-section class="--line-above">

            <div slot="header" translate>
                Limitations
            </div>

            <h1 class="margin-large-bottom" translate>
                Here you can specify the limitations of the vehicle group.
            </h1>

            <div class="control-row margin-larger-bottom">

                <number-input
                    value.bind="model.limits.volume"
                    label="above"
                    class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Max volume per route
                    </div>

                    <span slot="after" class="opacity-faded">
                        mÂ³
                    </span>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.limits.volume">
                        </required-validator>

                    </div>

                </number-input>

                <number-input
                    value.bind="model.limits.weight"
                    label="above"
                    class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Max weight per route
                    </div>

                    <span slot="after" class="opacity-faded">
                        kg
                    </span>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.limits.weight">
                        </required-validator>

                    </div>

                </number-input>

            </div>

            <div class="control-row margin-larger-bottom">

                <number-input
                    value.bind="model.limits.colliCount"
                    label="above"
                    class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Max number of colli per route
                    </div>

                    <span slot="after" class="opacity-faded">
                        colli
                    </span>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.limits.colliCount">
                        </required-validator>

                    </div>

                </number-input>

                <number-input
                    value.bind="model.limits.stopCount"
                    label="above"
                    class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Max number of stops per route
                    </div>

                    <span slot="after" class="opacity-faded">
                        stops
                    </span>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.limits.stopCount">
                        </required-validator>

                    </div>

                </number-input>

            </div>

            <div class="control-row">

                <number-input
                    value.bind="model.limits.time | scale: 1/60"
                    label="above"
                    class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Max time per route
                    </div>

                    <span slot="after" class="opacity-faded">
                        min
                    </span>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.limits.time">
                        </required-validator>

                    </div>

                </number-input>

                <number-input
                    value.bind="model.limits.distance"
                    label="above"
                    class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Max driving distance per route
                    </div>

                    <span slot="after" class="opacity-faded">
                        km
                    </span>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.limits.distance">
                        </required-validator>

                    </div>

                </number-input>

            </div>

        </modal-section>

        <modal-section class="--line-above">

            <div slot="header" translate>
                Locations
            </div>

            <h1 class="margin-large-bottom" translate>
                Here you can specify the location at which the vehicle must be picked up and returned.
            </h1>

            <div class="control-row margin-medium-bottom">

                <address-input
                    label="above"
                    value.bind="model.startLocation.location.address"
                    class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Start address
                    </div>

                </address-input>

                <address-input
                    label="above"
                    value.bind="model.endLocation.location.address"
                    class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        End address
                    </div>

                </address-input>

            </div>

            <div class="control-row">

                <number-input
                    value.bind="model.startLocation.time | scale: 1/60"
                    disabled.bind="model.startLocation.location.address == null"
                    label="above"
                    class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Task time at the start address
                    </div>

                    <span slot="after" class="opacity-faded">
                        min
                    </span>

                    <div slot="validation">

                        <required-validator
                            enabled.bind="model.startLocation.location.address != null"
                            value.bind="model.startLocation.time">
                        </required-validator>

                    </div>

                </number-input>

                <number-input
                    value.bind="model.endLocation.time | scale: 1/60"
                    disabled.bind="model.endLocation.location.address == null"
                    label="above"
                    class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Task time at the end address
                    </div>

                    <span slot="after" class="opacity-faded">
                        min
                    </span>

                    <div slot="validation">

                        <required-validator
                            enabled.bind="model.endLocation.location.address != null"
                            value.bind="model.endLocation.time">
                        </required-validator>

                    </div>

                </number-input>

            </div>

        </modal-section>

        <modal-section class="--line-above">

            <div slot="header" translate>
                Order tags
            </div>

            <h1 class="margin-large-bottom" translate>
                Here you can specify the order tags for which this vehicle group is applicable.
            </h1>

            <tags-input
                label="above"
                value.bind="model.orderTagsOneRequired"
                new.bind="true">

                <div slot="heading" translate>
                    Some of the tags
                </div>

            </tags-input>

        </modal-section>

        <modal-section class="--line-above">

            <div slot="header" translate>
                Route tags
            </div>

            <h1 class="margin-large-bottom" translate>
                Here you can specify the tags that should be assigned to routes using this vehicle group.
            </h1>

            <tags-input
                label="above"
                value.bind="model.routeTags"
                new.bind="true">

                <div slot="heading" translate>
                    Route tags to assign
                </div>

            </tags-input>

        </modal-section>

        <div if.bind="isNew" class="button-container margin-larger-top">

            <button appearance="solid" accent="primary" click.trigger="onSaveClick()" translate>
                Create vehicle rule
            </button>

        </div>

    </modal-panel>

</template>
