<template>

    <require from="app/components/info-icon/info-icon"></require>

    <require from="./general.scss"></require>

    <page-section>

        <h1 class="font-largest margin-bottom" tabindex="-1" autofocus="visible.bind: false" translate>
            General rules
        </h1>

        <div class="margin-large-bottom" translate>
            Here you can specify the general settings to use when planning routes.
        </div>

        <text-input label="above" value.bind="settings.name">

            <div slot="heading" translate>
                Name of the rule set
            </div>

            <div slot="validation">

                <required-validator
                    value.bind="settings.name">
                </required-validator>

            </div>

        </text-input>

    </page-section>

    <page-section class="--line-above">

        <div slot="header" translate>
            Begr√¶nsninger
        </div>

        <div class="margin-large-bottom" translate>
            Here you can specify the limitations that should be taken into account when planning routes.
        </div>

        <div class="control-row margin-large-bottom">

            <select-input
                label="above"
                none.bind="false"
                value.bind="selectedUturnStrategy"
                display-value.bind="selectedUturnStrategy.name"
                class="flex-basis-1-of-2">

                <div slot="heading" translate>
                    Strategy for U-turns
                </div>

                <item repeat.for="uturnStrategy of availableUturnStrategies" model.bind="uturnStrategy">
                    ${uturnStrategy.name}
                </item>

                <div slot="validation">

                    <required-validator
                        value.bind="selectedUturnStrategy">
                    </required-validator>

                </div>

            </select-input>

            <select-input
                label="above"
                none.bind="false"
                value.bind="selectedCurbApproachStrategy"
                display-value.bind="selectedCurbApproachStrategy.name"
                class="flex-basis-1-of-2">

                <div slot="heading" translate>
                    Strategy for curb approach
                </div>

                <item repeat.for="curbApproachStrategy of availableCurbApproachStrategies" model.bind="curbApproachStrategy">
                    ${curbApproachStrategy.name}
                </item>

                <div slot="validation">

                    <required-validator
                        value.bind="selectedCurbApproachStrategy">
                    </required-validator>

                </div>

            </select-input>

        </div>

        <div class="control-row margin-large-bottom">

            <number-input
                label="above"
                none.bind="false"
                value.bind="settings.restrictions.timeWindowAdjustmentDelivery.start | scale: 1/60"
                class="flex-basis-1-of-2"
                min.bind="0">

                <div slot="heading" translate>
                    Time frame narrowing to prevent early arrival
                </div>

                <span slot="after" class="opacity-faded" trasnslate>
                    min
                </span>

                <div slot="validation">

                    <required-validator
                        value.bind="settings.restrictions.timeWindowAdjustmentDelivery.start">
                    </required-validator>

                    <range-validator
                        active.bind="true"
                        value.bind="settings.restrictions.timeWindowAdjustmentDelivery.start"
                        min.bind="0">
                    </range-validator>

                </div>

            </number-input>

            <number-input
                label="above"
                none.bind="false"
                value.bind="settings.restrictions.timeWindowAdjustmentDelivery.end | scale: 1/60"
                class="flex-basis-1-of-2"
                min.bind="0">

                <div slot="heading" translate>
                    Time frame narrowing to prevent late arrival
                </div>

                <span slot="after" class="opacity-faded">
                    min
                </span>

                <div slot="validation">

                    <required-validator
                        value.bind="settings.restrictions.timeWindowAdjustmentDelivery.end">
                    </required-validator>

                    <range-validator
                        active.bind="true"
                        value.bind="settings.restrictions.timeWindowAdjustmentDelivery.end"
                        min.bind="0">
                    </range-validator>

                </div>

            </number-input>

        </div>

        <div class="control-row margin-large-bottom">

            <number-input
                label="above"
                value.bind="settings.restrictions.maxCalculationTime | scale: 1/60"
                class="flex-basis-1-of-2"
                min.bind="0">

                <div slot="heading" translate>
                    Max time for route calculation
                </div>

                <span slot="after" class="opacity-faded" translate>
                    min
                </span>

                <div slot="validation">

                    <required-validator
                        value.bind="settings.restrictions.maxCalculationTime">
                    </required-validator>

                    <range-validator
                        active.bind="true"
                        value.bind="settings.restrictions.maxCalculationTime"
                        min.bind="0"
                        min-inclusive.bind="false">
                    </range-validator>

                </div>

            </number-input>

            <div class="flex-basis-1-of-2"></div>

        </div>

        <div class="control-row">

            <check-toggle
                label="after"
                value.bind="settings.restrictions.ferriesAllowed"
                class="flex-basis-1-of-3">

                <div slot="heading" translate>
                    Allow ferries
                </div>

            </check-toggle>

            <check-toggle
                label="after"
                value.bind="settings.restrictions.privateRoadsAllowed"
                class="flex-basis-1-of-3">

                <div slot="heading" translate>
                    Allow private roads
                </div>

            </check-toggle>

            <check-toggle
                label="after"
                value.bind="settings.restrictions.oneRoutePlanPerStartLocation"
                class="flex-basis-1-of-3">

                <div slot="heading" translate>
                    One route per start location
                </div>

            </check-toggle>

        </div>

    </page-section>

    <page-section class="--line-above">

        <div slot="header" translate>
            Route creation
        </div>

        <h2 class="margin-large-bottom" translate>
            Here you can specify how the routes should be created, tagged and approved.
        </h2>

        <text-input
            label="above"
            trim.bind="false"
            value.bind="settings.routeCreation.routeNameTemplate"
            class="flex-basis-1-of-2 margin-large-bottom"
            ref="routeNameTempleteInputElement">

            <div slot="heading" translate>
                Template to use for the route
            </div>

            <div slot="after">

                <select-button appearance="text-without-hover" accent="primary">

                    <div slot="label" class="flex-row">
                        <icon name="placeholder-small" accent="primary" class="margin-right"></icon>
                        <span translate>
                            Insert placeholder
                        </span>
                    </div>

                    <item click.trigger="onRouteNamePlaceholderClick('{DayOfWeek}')">
                        <div accent="primary">
                            {DayOfWeek}
                        </div>
                        <div class="font-small margin-smallest-top opacity-faded" translate>
                            Day of week as letter, A = Monday, B = Tuesday etc.
                        </div>
                    </item>

                    <item click.trigger="onRouteNamePlaceholderClick('{StartLocation}')">
                        <div accent="primary">
                            {StartLocation}
                        </div>
                        <div class="font-small margin-smallest-top opacity-faded" translate>
                            First three letters of start location on route
                        </div>
                    </item>

                    <item click.trigger="onRouteNamePlaceholderClick('{EndLocation}')">
                        <div accent="primary">
                            {EndLocation}
                        </div>
                        <div class="font-small margin-smallest-top opacity-faded" translate>
                            First three letters of end location om route
                        </div>
                    </item>

                    <item click.trigger="onRouteNamePlaceholderClick('{Gate}')">
                        <div accent="primary">
                            {Gate}
                        </div>
                        <div class="font-small margin-smallest-top opacity-faded" translate>
                            Gate of the route
                        </div>
                    </item>

                    <item click.trigger="onRouteNamePlaceholderClick('{StartTime}')">
                        <div accent="primary">
                            {StartTime}
                        </div>
                        <div class="font-small margin-smallest-top opacity-faded" translate>
                            Start time of route, eg. 1040
                        </div>
                    </item>

                    <item click.trigger="onRouteNamePlaceholderClick('{Number}')">
                        <div accent="primary">
                            {Number}
                        </div>
                        <div class="font-small margin-smallest-top opacity-faded" translate>
                            Route number index in optimization, sorted by start time
                        </div>
                    </item>

                    <item click.trigger="onRouteNamePlaceholderClick('{Year}')">
                        <div accent="primary">
                            {Year}
                        </div>
                        <div class="font-small margin-smallest-top opacity-faded" translate>
                            Year of the day of delivery
                        </div>
                    </item>

                    <item click.trigger="onRouteNamePlaceholderClick('{Month}')">
                        <div accent="primary">
                            {Month}
                        </div>
                        <div class="font-small margin-smallest-top opacity-faded" translate>
                            Month of the day of delivery
                        </div>
                    </item>

                    <item click.trigger="onRouteNamePlaceholderClick('{Day}')">
                        <div accent="primary">
                            {Day}
                        </div>
                        <div class="font-small margin-smallest-top opacity-faded" translate>
                            Day of the delivery
                        </div>
                    </item>

                    <item click.trigger="onRouteNamePlaceholderClick('{StartLocationZip1}')">
                        <div accent="primary">
                            {StartLocationZip1}
                        </div>
                        <div class="font-small margin-smallest-top opacity-faded" translate>
                            First character in the zip code on the start location
                        </div>
                    </item>

                    <item click.trigger="onRouteNamePlaceholderClick('{StartLocationZip}')">
                        <div accent="primary">
                            {StartLocationZip}
                        </div>
                        <div class="font-small margin-smallest-top opacity-faded" translate>
                            Full zip code on the start location
                        </div>
                    </item>

                    <item click.trigger="onRouteNamePlaceholderClick('{LastDeliveryZip}')">
                        <div accent="primary">
                            {LastDeliveryZip}
                        </div>
                        <div class="font-small margin-smallest-top opacity-faded" translate>
                            Full zip code on last delivery
                        </div>
                    </item>

                </select-button>

            </div>

            <div slot="validation">

                <required-validator
                    value.bind="settings.routeCreation.routeNameTemplate">
                </required-validator>

            </div>

        </text-input>

        <tags-input
            label="above"
            value.bind="settings.routeCreation.routeTags"
            new.bind="true"
            class="margin-large-bottom">

            <div slot="heading" translate>
                Tags to add to the routes
            </div>

        </tags-input>

        <check-toggle label="after" value.bind="settings.routeCreation.manualApproval">

            <span slot="heading">

                <span translate>
                    Approve routes manually
                </span>

            </div>

        </check-toggle>

    </page-section>

</template>
