<template>

    <require from="app/components/info-icon/info-icon"></require>

    <require from="./general.scss"></require>

    <page-section>

        <h1 class="font-largest margin-bottom" tabindex="-1" autofocus="visible.bind: false" translate>
            General rules for route planning
        </h1>

        <div class="margin-large-bottom" translate>
            Here you can specify the general settings to use when planning the routes.
        </div>

        <text-input label="above" value.bind="settings.name">

            <div slot="heading" translate>
                Name of the rule set
            </div>

            <div slot="validation">

                <required-validator
                    value.bind="settings.name">
                </required-validator>

            </div>

        </text-input>

    </page-section>

    <page-section class="--line-above">

        <div slot="header" translate>
            Begr√¶nsninger
        </div>

        <div class="margin-large-bottom" translate>
            Here you can specify the limitations that should be taken into account when planning the routes.
        </div>

        <div class="control-row margin-large-bottom">

            <select-input
                label="above"
                none.bind="false"
                value.bind="settings.restrictions.uturnStrategy"
                display-value.bind="settings.restrictions.uturnStrategy.name"
                class="flex-basis-1-of-2">

                <div slot="heading" translate>
                    Strategy for U-turns
                </div>

                <item repeat.for="uturnStrategy of uturnStrategies" model.bind="uturnStrategy">
                    ${uturnStrategy.name}
                </item>

                <div slot="validation">

                    <required-validator
                        value.bind="settings.restrictions.uturnStrategy">
                    </required-validator>

                </div>

            </select-input>

            <select-input
                label="above"
                none.bind="false"
                value.bind="settings.restrictions.curbApproachStrategy"
                display-value.bind="settings.restrictions.curbApproachStrategy.name"
                class="flex-basis-1-of-2">

                <div slot="heading" translate>
                    Strategy for curb approach
                </div>

                <item repeat.for="curbApproachStrategy of curbApproachStrategies" model.bind="status">
                    ${curbApproachStrategy.name}
                </item>

                <div slot="validation">

                    <required-validator
                        value.bind="settings.restrictions.curbApproachStrategy">
                    </required-validator>

                </div>

            </select-input>

        </div>

        <div class="control-row margin-large-bottom">

            <number-input
                label="above"
                none.bind="false"
                value.bind="settings.restrictions.timeWindowAdjustment.start"
                class="flex-basis-1-of-2">

                <div slot="heading" translate>
                    Time frame narrowing to prevent early arrival
                </div>

                <span slot="after" class="opacity-faded">
                    min
                </span>

                <div slot="validation">

                    <required-validator
                        value.bind="settings.restrictions.timeWindowAdjustment.start">
                    </required-validator>

                </div>

            </number-input>

            <number-input
                label="above"
                none.bind="false"
                value.bind="settings.restrictions.timeWindowAdjustment.end"
                class="flex-basis-1-of-2">

                <div slot="heading" translate>
                    Time frame narrowing to prevent late arrival
                </div>

                <span slot="after" class="opacity-faded">
                    min
                </span>

                <div slot="validation">

                    <required-validator
                        value.bind="settings.restrictions.timeWindowAdjustment.end">
                    </required-validator>

                </div>

            </number-input>

        </div>

        <div class="control-row margin-large-bottom">

            <number-input
                label="above"
                value.bind="settings.restrictions.maxCalculationTime"
                class="flex-basis-1-of-2">

                <div slot="heading">
                    Max time for route calculation
                </div>

                <span slot="after" class="opacity-faded">
                    min
                </span>

                <div slot="validation">

                    <required-validator
                        value.bind="settings.restrictions.maxCalculationTime">
                    </required-validator>

                </div>

            </number-input>

            <div class="flex-basis-1-of-2"></div>

        </div>

        <div class="control-row margin-large-bottom">

            <check-toggle
                label="after"
                value.bind="settings.restrictions.ferriesAllowed"
                class="flex-basis-1-of-3">

                <div slot="heading" translate>
                    Allow ferries
                </div>

            </check-toggle>

            <check-toggle
                label="after"
                value.bind="settings.restrictions.privateRoadsAllowed"
                class="flex-basis-1-of-3">

                <div slot="heading" translate>
                    Allow private roads
                </div>

            </check-toggle>

            <check-toggle
                label="after"
                value.bind="settings.restrictions.highwaysAllowed"
                class="flex-basis-1-of-3">

                <div slot="heading" translate>
                    Allow highways
                </div>

            </check-toggle>

        </div>

        <div class="control-row">

            <check-toggle
                label="after"
                value.bind="settings.restrictions.oneRoutePlanPerStartLocation"
                class="flex-basis-1-of-3">

                <div slot="heading" translate>
                    One route per start location
                </div>

            </check-toggle>

        </div>

    </page-section>

    <page-section class="--line-above">

        <div slot="header" translate>
            Route creation
        </div>

        <h2 class="margin-large-bottom" translate>
            Here you can specify how the routes should be created, tagged and approved.
        </h2>

        <text-input
            label="above"
            trim.bind="false"
            value.bind="settings.restrictions.routeNameTemplate"
            class="flex-basis-1-of-2 margin-large-bottom"
            ref="routeNameTempleteInputElement">

            <div slot="heading" translate>
                Template to use for the route
            </div>

            <div slot="after">

                <select-button appearance="text-without-hover" accent="primary">

                    <div slot="label" class="flex-row">
                        <icon name="placeholder-small" accent="primary" class="margin-right"></icon>
                        <span translate>
                            Insert placeholder
                        </span>
                    </div>

                    <item click.trigger="onRouteNamePlaceholderClick('{placeholder-1}')">
                        Placeholder 1
                    </item>

                    <item click.trigger="onRouteNamePlaceholderClick('{placeholder-2}')">
                        Placeholder 2
                    </item>

                    <item click.trigger="onRouteNamePlaceholderClick('{placeholder-3}')">
                        Placeholder 3
                    </item>

                </select-button>

            </div>

            <div slot="validation">

                <required-validator
                    value.bind="settings.restrictions.routeNameTemplate">
                </required-validator>

            </div>

        </text-input>

        <tags-input
            label="above"
            filter="auto"
            value.bind="settings.routeCreation.routeTags"
            filter-value.bind="routeTagsFilterValue"
            class="margin-large-bottom">

            <div slot="heading" translate>
                Tags to add to the routes
            </div>

            <div slot="placeholder" translate>
                Add tags
            </div>

            <item if.bind="routeTagsFilterValue && !settings.routeCreation.routeTags.includes(routeTagsFilterValue)" model.bind="routeTagsFilterValue">

                <div class="flex-row">

                    <div>
                        ${routeTagsFilterValue}
                    </div>

                    <div class="opacity-faded flex-push-right" translate>
                        New tag
                    </div>

                </div>

            </item>

        </tags-input>

        <check-toggle label="after" value.bind="settings.routeCreation.manualApproval">

            <span slot="heading">

                <span translate>
                    Approve routes manually
                </span>

            </div>

        </check-toggle>

    </page-section>

</template>
