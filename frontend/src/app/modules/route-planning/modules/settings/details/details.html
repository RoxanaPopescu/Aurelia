<template>

    <require from="app/components/name-value-pair/name-value-pair"></require>
    <require from="app/components/name-value-list/name-value-list"></require>

    <require from="./modules/general/general"></require>
    <require from="./modules/geographic-areas/geographic-areas"></require>
    <require from="./modules/vehicle-groups/vehicle-groups"></require>
    <require from="./modules/start-locations/start-locations"></require>
    <require from="./modules/task-times/task-times"></require>

    <require from="./details.scss"></require>

    <page name="settings-details">

        <page-content class="${tab === 'geographic-areas' ? 'page-content-stretch' : ''}" scroll scroll.ref="scroll" validation validation.ref="validation">

            <page-header scroll-fade>

                <h1 class="font-largest margin-bottom">
                    <path-nav>

                        <a accent="inherit" href="/route-planning/list" translate>
                            Route planning
                        </a>

                        <a accent="inherit" href="/route-planning/rule-sets/list" translate>
                            Rule sets
                        </a>

                        <span>

                            <template if.bind="!isNew">
                                ${settings.name}
                            </template>

                            <template if.bind="isNew" translate>
                                New rule set
                            </template>

                        </span>

                    </path-nav>
                </h1>

                <toolbar>

                    <tab-nav appearance="solid" value.bind="tab">

                        <tab name="general" invalid.bind="generalValidation.invalid" translate>
                            General rules
                        </tab>

                        <tab name="geographic-areas" invalid.bind="geographicAreasValidation.invalid" translate>
                            Geographic rules
                        </tab>

                        <tab name="vehicle-groups" invalid.bind="vehicleGroupsValidation.invalid" translate>
                            Vehicle rules
                        </tab>

                        <tab name="start-locations" invalid.bind="startLocationsValidation.invalid" translate>
                            Start location rules
                        </tab>

                        <tab name="task-times" invalid.bind="taskTimesValidation.invalid" translate>
                            Task time rules
                        </tab>

                    </tab-nav>

                    <div class="flex-push-right control-row">

                        <button if.bind="isNew" appearance="outline" accent="primary" page-href="path: /route-planning/rule-sets/list" translate>
                            Cancel
                        </button>

                        <button appearance="solid" accent="primary" click.trigger="onSaveClick()">

                            <template if.bind="isNew" translate>
                                Create rule set
                            </template>

                            <template if.bind="!isNew" translate>
                                Save changes
                            </template>

                        </button>

                    </div>

                </toolbar>

            </page-header>

            <name-value-list class="font-small opacity-faded">

                <name-value-pair if.bind="settings.metadata.lastModified != null">

                    <div slot="name" translate>
                        Last modified
                    </div>

                    <div slot="value">
                        ${settings.metadata.lastModified | dateTime: 'narrow'}
                        <span class="opacity-faded" translate>
                            by
                        </span>
                        ${settings.metadata.lastModifiedBy}
                    </div>

                </name-value-pair>

                <name-value-pair if.bind="settings.metadata.created != null">

                    <div slot="name" translate>
                        Created
                    </div>

                    <div slot="value">
                        ${settings.metadata.created | dateTime: 'narrow'}
                        <span class="opacity-faded" translate>
                            by
                        </span>
                        ${settings.metadata.createdBy}
                    </div>

                </name-value-pair>

            </name-value-list>

            <general
                show.bind="tab === 'general'"
                settings.bind="settings"
                validation
                validation.ref="generalValidation">
            </general>

            <geographic-areas
                show.bind="tab === 'geographic-areas'"
                visible.bind="tab === 'geographic-areas'"
                settings.bind="settings"
                validation
                validation.ref="geographicAreasValidation">
            </geographic-areas>

            <vehicle-groups
                show.bind="tab === 'vehicle-groups'"
                settings.bind="settings"
                validation
                validation.ref="vehicleGroupsValidation">
            </vehicle-groups>

            <start-locations
                show.bind="tab === 'start-locations'"
                settings.bind="settings"
                validation
                validation.ref="startLocationsValidation">
            </start-locations>

            <task-times
                show.bind="tab === 'task-times'"
                settings.bind="settings"
                validation
                validation.ref="taskTimesValidation">
            </task-times>

        </page-content>

    </page>

</template>
