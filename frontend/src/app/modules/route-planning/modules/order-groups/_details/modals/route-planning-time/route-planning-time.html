<template>

    <require from="./route-planning-time.scss"></require>

    <modal-backdrop close-modal.bind="true"></modal-backdrop>

    <modal-dialog
        name="route-planning-time"
        close-button.bind="true"
        close-shortcut.bind="true"
        scroll
        validation
        validation.ref="validation">

        <modal-header>

            <h1 class="font-larger" tabindex="-1" autofocus="visible.bind: false">

                <span if.bind="create" translate>
                    New route planning time
                </span>

                <span if.bind="!create" translate>
                    Edit route planning time
                </span>

            </h1>

        </modal-header>

        <modal-section class="margin-bottom">

            <div class="margin-bottom" translate>
                For orders to be delivered…
            </div>

            <div class="control-row">

                <select-input
                    label="above"
                    value.bind="model.routePlanningTime.delivery.from.dayOfWeek"
                    display-value.bind="model.routePlanningTime.delivery.from.dayOfWeek | weekday"
                    none.bind="false"
                    filter="auto"
                    fixed.bind="true">

                    <div slot="heading" translate>
                        Day of week
                    </div>

                    <span slot="placeholder" translate>
                        Choose a day
                    </span>

                    <item repeat.for="dayOfWeek of [1, 2, 3, 4, 5, 6, 7]" model.bind="dayOfWeek">
                        ${dayOfWeek | weekday}
                    </item>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.routePlanningTime.delivery.from.dayOfWeek">
                        </required-validator>

                    </div>

                </select-input>

                <time-input
                    label="above"
                    value.bind="model.routePlanningTime.delivery.from.timeOfDay"
                    none.bind="false"
                    max.bind="model.routePlanningTime.delivery.to.timeOfDay"
                    max-inclusive.bind="false"
                    fixed.bind="true">

                    <div slot="heading" translate>
                        From time
                    </div>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.routePlanningTime.delivery.from.timeOfDay">
                        </required-validator>

                        <range-validator
                            value.bind="model.routePlanningTime.delivery.from.timeOfDay"
                            max.bind="model.routePlanningTime.delivery.to.timeOfDay"
                            max-inclusive.bind="false">

                            <template replace-part="invalid-max" translate>
                                Please choose a time before the to time.
                            </template>

                        </range-validator>

                    </div>

                </time-input>

                <time-input
                    label="above"
                    value.bind="model.routePlanningTime.delivery.to.timeOfDay"
                    none.bind="false"
                    min.bind="model.routePlanningTime.delivery.from.timeOfDay"
                    min-inclusive.bind="false"
                    fixed.bind="true">

                    <div slot="heading" translate>
                        To time
                    </div>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.routePlanningTime.delivery.to.timeOfDay">
                        </required-validator>

                        <range-validator
                            value.bind="model.routePlanningTime.delivery.to.timeOfDay"
                            min.bind="model.routePlanningTime.delivery.from.timeOfDay"
                            min-inclusive.bind="false">

                            <template replace-part="invalid-min" translate>
                                Please choose a time after the from time.
                            </template>

                        </range-validator>

                    </div>

                </time-input>

            </div>

        </modal-section>

        <modal-section class="margin-bottom">

            <div class="margin-bottom" translate>
                Schedule route planning to run…
            </div>

            <div class="control-row">

                <select-input
                    label="above"
                    value.bind="model.routePlanningTime.planning.dayOfWeek"
                    display-value.bind="model.routePlanningTime.planning.dayOfWeek | weekday"
                    none.bind="false"
                    filter="auto"
                    fixed.bind="true">

                    <div slot="heading" translate>
                        Day of week
                    </div>

                    <span slot="placeholder" translate>
                        Choose a day
                    </span>

                    <item repeat.for="dayOfWeek of [1, 2, 3, 4, 5, 6, 7]" model.bind="dayOfWeek">
                        ${dayOfWeek | weekday}
                    </item>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.routePlanningTime.planning.dayOfWeek">
                        </required-validator>

                    </div>

                </select-input>

                <time-input
                    label="above"
                    value.bind="model.routePlanningTime.planning.timeOfDay"
                    none.bind="false"
                    fixed.bind="true">

                    <div slot="heading" translate>
                        Time
                    </div>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.routePlanningTime.planning.timeOfDay">
                        </required-validator>

                    </div>

                </time-input>

            </div>

        </modal-section>

        <modal-section>

            <div class="margin-bottom" translate>
                Schedule the next route planning to run…
            </div>

            <div class="control-row">

                <date-input
                    label="above"
                    value.bind="nextPlanningDate"
                    min="today"
                    zone.bind="model.timeZone"
                    fixed.bind="true">

                    <div slot="heading" translate>
                        Date
                    </div>

                    <div slot="validation">

                        <required-validator
                            value.bind="nextPlanningDate">
                        </required-validator>

                    </div>

                </date-input>

                <time-input
                    label="above"
                    value.bind="nextPlanningTime"
                    none.bind="false"
                    fixed.bind="true">

                    <div slot="heading" translate>
                        Time
                    </div>

                    <div slot="validation">

                        <required-validator
                            value.bind="nextPlanningTime">
                        </required-validator>

                    </div>

                </time-input>

            </div>

        </modal-section>

        <modal-footer>

            <div class="button-row flex-push-right">

                <button appearance="solid" accent="primary" click.delegate="onSaveClick()">

                    <span if.bind="!create" translate>
                        Done
                    </span>

                </button>

            </div>

        </modal-footer>

    </modal-dialog>

</template>
