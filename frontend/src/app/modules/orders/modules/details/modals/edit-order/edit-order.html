<template>

    <require from="./edit-order.scss"></require>
    <require from="app/components/address-input/address-input"></require>
    <require from="app/components/info-icon/info-icon"></require>

    <modal-backdrop close="all"></modal-backdrop>

    <modal-panel name="edit-orders" position="right" close-button.bind="true" close-shortcut.bind="true" scroll validation validation.ref="validation">

        <div slot="actions">

            <button
                appearance="icon"
                title.translate="Save changes"
                click.trigger="onSaveClick()">
                <icon name="save"></icon>
            </button>

        </div>

        <modal-header scroll-fade>

            <h1 class="font-largest" tabindex="-1" autofocus="visible.bind: false">

                <path-nav if.bind="!model.isNew">

                    <a accent="inherit" click.trigger="onCancel()" translate>
                        Order ${model.slug}
                    </a>

                    <div translate>
                        Edit
                    </div>

                </path-nav>

            </h1>

        </modal-header>

        <modal-section>

            <div slot="header" translate>
                Order information
            </div>

            <div class="control-row margin-large-bottom">

                <text-input label="above" value.bind="model.slug" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Order ID
                    </div>

                </text-input>

                <text-input label="above" value.bind="model.relationalId" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Related order ID
                    </div>

                </text-input>

            </div>

        </modal-section>

        <modal-section class="margin-bottom --line-above">

            <div slot="header" translate>
                Pickup
            </div>

            <div class="control-row margin-large-bottom">

                <address-input label="above" value.bind="model.pickup.location.address" class="flex-basis-1-of-1">

                    <div slot="heading" translate>
                        Address
                    </div>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.pickup.location.address.primary">
                        </required-validator>

                    </div>

                </address-input>

            </div>

            <div class="control-row margin-large-bottom">

                <text-input label="above" value.bind="model.pickup.contactName" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Name
                    </div>

                </text-input>

                <text-input label="above" value.bind="model.pickup.companyName" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Company name
                    </div>

                </text-input>

            </div>

            <div class="control-row margin-large-bottom">

                <text-input label="above" value.bind="model.pickup.contactPhoneNumber" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Phone number
                    </div>

                </text-input>

                <text-input label="above" value.bind="model.pickup.contactEmail" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        E-mail
                    </div>

                </text-input>

            </div>

            <div class="control-row margin-large-bottom">

                <date-input
                    class="flex-basis-1-of-2"
                    label="above"
                    value.bind="pickupDate">

                    <div slot="heading" translate>
                        Arrival date
                    </div>

                    <div slot="validation">

                        <required-validator
                            value.bind="pickupDate">
                        </required-validator>

                    </div>

                </date-input>

                <div class="control-row flex-basis-1-of-2">

                    <time-input label="above" value.bind="earliestPickupArrivalTime" class="flex-basis-1-of-2">

                        <div slot="heading" translate>
                            From
                        </div>

                        <div slot="validation">

                            <required-validator
                                value.bind="earliestPickupArrivalTime">
                            </required-validator>

                        </div>

                    </time-input>

                    <time-input label="above" value.bind="latestPickupArrivalTime" class="flex-basis-1-of-2">

                        <div slot="heading" translate>
                            To
                        </div>

                        <div slot="validation">

                            <required-validator
                                value.bind="latestPickupArrivalTime">
                            </required-validator>

                        </div>

                    </time-input>

                </div>

            </div>

            <div class="control-row margin-large-bottom">

                <text-input label="above" lines.bind="3" value.bind="model.pickup.instructions" class="flex-basis-1-of-1">

                    <div slot="heading" translate>
                        Instructions
                    </div>

                    <span slot="placeholder" translate>
                        Type any instructions that might help the driver
                    </span>

                </text-input>

            </div>

            <div class="control-row">

                <number-input label="above" value.bind="model.pickup.estimatedTaskTime | scale: 1/60" class="flex-basis-1-of-1" min.bind="0">

                    <div slot="heading" translate>
                        Estimated task time
                    </div>

                    <span slot="placeholder" translate>
                        Use default task time
                    </span>

                    <span slot="after" class="opacity-faded" translate>
                        min
                    </span>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.pickup.estimatedTaskTime">
                        </required-validator>

                        <range-validator
                            active.bind="true"
                            value.bind="model.pickup.estimatedTaskTime"
                            min.bind="0">
                        </range-validator>

                    </div>

                </number-input>

            </div>

        </modal-section>

        <modal-section class="margin-bottom --line-above">

            <div slot="header" translate>
                Delivery
            </div>

            <div class="control-row margin-large-bottom">

                <address-input label="above" value.bind="model.delivery.location.address" class="flex-basis-1-of-1">

                    <div slot="heading" translate>
                        Address
                    </div>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.delivery.location.address.primary">
                        </required-validator>

                    </div>

                </address-input>

            </div>

            <div class="control-row margin-large-bottom">

                <text-input label="above" value.bind="model.delivery.contactName" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Name
                    </div>

                </text-input>

                <text-input label="above" value.bind="model.delivery.companyName" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Company name
                    </div>

                </text-input>

            </div>

            <div class="control-row margin-large-bottom">

                <text-input label="above" value.bind="model.delivery.contactPhoneNumber" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Phone number
                    </div>

                </text-input>

                <text-input label="above" value.bind="model.delivery.contactEmail" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        E-mail
                    </div>

                </text-input>

            </div>

            <div class="control-row margin-large-bottom">

                <date-input
                    class="flex-basis-1-of-2"
                    label="above"
                    value.bind="deliveryDate">

                    <div slot="heading" translate>
                        Arrival date
                    </div>

                    <div slot="validation">

                        <required-validator
                            value.bind="deliveryDate">
                        </required-validator>

                    </div>

                </date-input>

                <div class="control-row flex-basis-1-of-2">

                    <time-input label="above" value.bind="earliestDeliveryArrivalTime" class="flex-basis-1-of-2">

                        <div slot="heading" translate>
                            From
                        </div>

                        <div slot="validation">

                            <required-validator
                                value.bind="earliestDeliveryArrivalTime">
                            </required-validator>

                        </div>

                    </time-input>

                    <time-input label="above" value.bind="latestDeliveryArrivalTime" class="flex-basis-1-of-2">

                        <div slot="heading" translate>
                            To
                        </div>

                        <div slot="validation">

                            <required-validator
                                value.bind="latestDeliveryArrivalTime">
                            </required-validator>

                        </div>

                    </time-input>

                </div>

            </div>

            <div class="control-row margin-large-bottom">

                <text-input label="above" lines.bind="3" value.bind="model.delivery.instructions" class="flex-basis-1-of-1">

                    <div slot="heading" translate>
                        Instructions
                    </div>

                    <span slot="placeholder" translate>
                        Type any instructions that might help the driver
                    </span>

                </text-input>

            </div>

            <div class="control-row">

                <number-input label="above" value.bind="model.delivery.estimatedTaskTime | scale: 1/60" class="flex-basis-1-of-1" min.bind="0">

                    <div slot="heading" translate>
                        Estimated task time
                    </div>

                    <span slot="placeholder" translate>
                        Use default task time
                    </span>

                    <span slot="after" class="opacity-faded" translate>
                        min
                    </span>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.delivery.estimatedTaskTime">
                        </required-validator>

                        <range-validator
                            active.bind="true"
                            value.bind="model.delivery.estimatedTaskTime"
                            min.bind="0">
                        </range-validator>

                    </div>

                </number-input>

            </div>

        </modal-section>

        <modal-section class="--line-above">

            <div slot="header" translate>
                Tags
            </div>

            <tags-input
                label="above"
                value.bind="model.tags"
                new.bind="true"
                class="flex-basis-1-of-1">

                <div slot="value">
                    <tag model.bind="tag" repeat.for="tag of model.tags">
                        ${tag}
                    </tag>
                </div>
            </tags-input>

        </modal-section>

    </modal-panel>

</template>
