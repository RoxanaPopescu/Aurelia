<template>

    <require from="app/components/identity-picture/identity-picture"></require>

    <require from="./push-drivers.scss"></require>

    <modal-backdrop close="all"></modal-backdrop>

    <modal-panel scroll scroll.ref="scroll" name="push-drivers" position="right" close-button.bind="true" close-shortcut.bind="true" scroll>

        <modal-header scroll-fade>

            <h1 class="font-largest margin-bottom flex-row">
                <div accent.bind="attr" translate>
                    Push to drivers
                </div>

                <div if.bind="route" class="opacity-faded-more margin-left-large margin-right-large">
                    –
                </div>

                <div class="opacity-faded" if.bind="route">
                    ${route.slug}
                </div>
            </h1>

            <search-input value.bind="searchQuery & debounce: 200" autofocus ref="queryInputElement">

                <span slot="before" class="opacity-faded">
                    <icon name="md-search" class="font-larger"></icon>
                </span>

                <span slot="placeholder" translate>
                    Type to search…
                </span>

            </search-input>

        </modal-header>

        <modal-section if.bind="true" class="margin-bottom">

            <data-table sorting.bind="sorting" busy.bind="updateOperation.pending" appearance="rows">

                <data-table-headers>

                    <data-table-cell name="name">
                        <span class="text-truncate" translate>
                            Name
                        </span>
                    </data-table-cell>

                    <data-table-cell name="email">
                        <span class="text-truncate" translate>
                            Email
                        </span>
                    </data-table-cell>

                    <data-table-cell name="phone">
                        <span class="text-truncate" translate>
                            Phone
                        </span>
                    </data-table-cell>

                    <data-table-cell>
                        <span class="text-truncate" translate>
                            Vehicles
                        </span>
                    </data-table-cell>

                    <data-table-cell name="id" align="right">
                        <span class="text-truncate" translate>
                            ID
                        </span>
                    </data-table-cell>

                </data-table-headers>

                <template repeat.for="driver of results">

                    <data-table-row click.call="onDriverClick(driver)">

                        <data-table-cell>
                            <span class="text-truncate">
                                ${driver.name}
                            </span>
                        </data-table-cell>

                        <data-table-cell>
                            <span class="text-truncate">
                                ${driver.email}
                            </span>
                        </data-table-cell>

                        <data-table-cell>
                            <span class="text-truncate">
                                ${driver.phone}
                            </span>
                        </data-table-cell>

                        <data-table-cell>
                            <span class="text-truncate">
                                ${driver.vehicleTypes | map: 'name' | list: 'short'}
                            </span>
                        </data-table-cell>

                        <data-table-cell align="right">
                            <span class="text-truncate">
                                ${driver.id}
                            </span>
                        </data-table-cell>

                    </data-table-row>

                </template>

            </data-table>

            <busy-indicator if.bind="results == null" class="margin-largest"></busy-indicator>

            <empty-indicator if.bind="results.length == 0" class="margin-largest">
                <div slot="heading" translate>No results</div>
            </empty-indicator>

        </modal-section>

    </modal-panel>

</template>
