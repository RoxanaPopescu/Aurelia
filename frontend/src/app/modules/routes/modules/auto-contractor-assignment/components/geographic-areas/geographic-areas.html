<template class="flex-grow flex-column min-height-0">

    <require from="app/components/accordion/accordion"></require>
    <require from="app/components/name-value-pair/name-value-pair"></require>
    <require from="./components/geographic-areas-map/geographic-areas-map"></require>

    <require from="./geographic-areas.scss"></require>

    <div class="flex-grow flex-row min-height-0">

        <div class="flex-basis-1-of-3 geographic-areas-list" scroll>

            <page-section class="flex-grow">

                <check-toggle label="after" class="geographic-areas-list-toggle-all margin-bottom" value.to-view="allAreasSelected" change.trigger="onToggleAllAreas()">

                    <span slot="heading" translate>
                        Select all
                    </span>

                </check-toggle>

                <list-layout if.bind="settings.rules.length > 0">

                    <accordion repeat.for="area of settings.rules" expandable.bind="false" accent.bind="'data-' + area.color & attr">

                        <div slot="header">

                            <check-toggle class="margin-right" value.to-view="area.selected" change.trigger="onToggleArea(area)"></check-toggle>

                            <div class="font-large">
                                ${area.label}
                            </div>

                            <div class="flex-push-right icon-row">

                                <button
                                    title.translate="Edit area"
                                    appearance="none"
                                    accent="primary"
                                    disabled.bind="enableDrawing"
                                    click.trigger="onEditAreaClick($index)">

                                    <icon name="edit-small"></icon>

                                </button>

                                <button
                                    title.translate="Delete area"
                                    appearance="none"
                                    accent="primary"
                                    disabled.bind="enableDrawing"
                                    click.trigger="onDeleteAreaClick($index)">

                                    <icon name="delete-small"></icon>

                                </button>

                            </div>

                        </div>

                    </accordion>

                </list-layout>

                <empty-indicator if.bind="settings.rules.length == 0" size="medium" icon="empty-map-drawing" class="margin-large-bottom">
                    <div slot="heading" translate>
                        No areas specified
                    </div>
                </empty-indicator>

                <button
                    appearance="outline"
                    accent="primary"
                    class="geographic-area-add-button margin-large-top"
                    disabled.bind="enableDrawing"
                    click.trigger="onAddAreaClick()">

                    <icon name="plus-small" class="margin-right"></icon>

                    <span translate>
                        New area
                    </span>

                </button>

            </page-section>

        </div>

        <geographic-areas-map
            class="flex-basis-2-of-3"
            areas.bind="visible ? settings.rules : undefined"
            area-click.call="onAreaClick(area)"
            enable-drawing.bind="enableDrawing"
            drawing-completed.call="onDrawingCompleted(polygon)"
            drawing-cancelled.call="onDrawingCancelled()">
        </geographic-areas-map>

    </div>

</template>
