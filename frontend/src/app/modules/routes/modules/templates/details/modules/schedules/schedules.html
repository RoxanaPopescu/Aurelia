<template>

    <require from="app/components/info-icon/info-icon"></require>

    <require from="./schedules.scss"></require>

    <page-section>

        <div class="font-largest margin-bottom" tabindex="-1" autofocus="visible.bind: false" translate>
            Schedules
        </div>

        <div translate>
            Here you can add or edit schedules for this template
        </div>

    </page-section>

    <page-section class="--line-above">

        <data-table
            appearance="cards"
            sorting.bind="sorting">

            <data-table-headers>

                <data-table-cell>
                    <span class="text-truncate" translate>
                        Next execution
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate" translate>
                        Execution
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate" translate>
                        Route status
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate" translate>
                        Route driver
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate" translate>
                        Route day of week
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate" translate>
                        Status
                    </span>
                </data-table-cell>

                <data-table-cell align="right">
                    <!-- Icons -->
                </data-table-cell>

            </data-table-headers>

            <data-table-row repeat.for="stop of template.stops" model.bind="stop">

                <data-table-cell>
                    <span class="text-truncate">
                        Next executoon
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate">
                        Monday, 12:00
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate">
                        Route status
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate">
                        Yes / No
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate">
                        Monday
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate">
                        Not-accepted
                    </span>
                </data-table-cell>

                <data-table-cell align="right">

                    <div class="icon-row">

                        <button appearance="none" accent="primary" click.trigger="onEditStopClick(stop)">
                            <icon name="edit-small"></icon>
                        </button>

                        <button appearance="none" accent="primary" click.trigger="onRemoveStopClick($index)">
                            <icon name="delete-small"></icon>
                        </button>

                    </div>

                </data-table-cell>

            </data-table-row>

        </data-table>

        <div if.bind="hasInvalidFirstStop || hasInvalidLastStop || hasInvalidReturnStop" class="font-small margin-top">

            <custom-validator
                valid.bind="!hasInvalidFirstStop">

                <template replace-part="invalid" translate>
                    The first stop must be a pickup stop.
                </template>

            </custom-validator>

            <custom-validator
                valid.bind="!hasInvalidLastStop">

                <template replace-part="invalid" translate>
                    The last stop cannot be a pickup stop.
                </template>

            </custom-validator>

            <custom-validator
                valid.bind="!hasInvalidReturnStop">

                <template replace-part="invalid" translate>
                    Only the last stop can be a return stop.
                </template>

            </custom-validator>

        </div>

        <empty-indicator if.bind="template.stops.length == 0" class="margin-large-top">
            <div slot="heading" translate>No stops</div>
        </empty-indicator>

        <button
            if.bind="template.stops != null"
            appearance="outline"
            accent="primary"
            class="margin-large-top"
            click.trigger="onAddStopClick()">
            <icon name="md-add" class="font-larger line-height-1">
        </button>

    </page-section>

</template>
