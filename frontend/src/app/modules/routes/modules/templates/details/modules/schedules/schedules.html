<template>

    <require from="app/components/info-icon/info-icon"></require>

    <require from="./schedules.scss"></require>

    <page-section>

        <div class="font-largest margin-bottom" tabindex="-1" autofocus="visible.bind: false" translate>
            Schedules
        </div>

        <div translate>
            Here you can add or edit schedules for this template
        </div>

    </page-section>

    <page-section class="--line-above">

        <data-table
            appearance="rows"
            sorting.bind="sorting"
            append.call="onAddClick()">

            <data-table-headers>

                <data-table-cell>
                    <span class="text-truncate" translate>
                        Status
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate" translate>
                        Next execution
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate" translate>
                        Weekly execution
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate" translate>
                        Day of week
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate" translate>
                        Assigned driver
                    </span>
                </data-table-cell>

                <data-table-cell align="right">
                    <!-- Icons -->
                </data-table-cell>

            </data-table-headers>

            <data-table-row repeat.for="schedule of template.schedules" model.bind="schedule">

                <data-table-cell>
                    <span class="text-truncate">
                        ${schedule.routeStatus.name}
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate">
                        ${schedule.nextExecution | dateTime: 'narrow' : false}
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate">
                        ${schedule.executeDayOfWeek | weekday | case: 'sentence'}, ${schedule.executeTime | time: 'narrow' : false}
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate">
                        ${schedule.routeDayOfWeek | weekday | case: 'sentence'}
                    </span>
                </data-table-cell>

                <data-table-cell>
                    <span class="text-truncate">
                        <template if.bind="schedule.routeDriverId" translate>
                            Yes
                        </template>
                        <template if.bind="!schedule.routeDriverId" translate>
                            No
                        </template>
                    </span>
                </data-table-cell>

                <data-table-cell align="right">

                    <div class="icon-row">

                        <button appearance="none" accent="primary" click.trigger="onPauseClick(schedule)">
                            <icon if.bind="schedule.paused" name="play"></icon>
                            <icon if.bind="!schedule.paused" name="pause"></icon>
                        </button>

                        <button appearance="none" accent="primary" click.trigger="onEditClick(schedule)">
                            <icon name="edit-small"></icon>
                        </button>

                        <button appearance="none" accent="primary" click.trigger="onRemoveClick($index)">
                            <icon name="delete-small"></icon>
                        </button>

                    </div>

                </data-table-cell>

            </data-table-row>

            <template replace-part="append" translate>
                Add schedule
            </template>

        </data-table>

    </page-section>

</template>
