<template>

    <require from="app/components/address-input/address-input"></require>

    <require from="./stop-details.scss"></require>

    <modal-backdrop close="all"></modal-backdrop>

    <modal-panel name="stop-details" position="right" close-button.bind="true" close-shortcut.bind="true" scroll validation validation.ref="validation">

        <modal-header scroll-fade>

            <h1 class="font-largest" tabindex="-1" autofocus="visible.bind: false">

                <span if.bind="!model.id">

                    <span if.bind="model.stopNumber - 1 !== template.stops.length && model.stopNumber !== 1" translate>
                        New stop after stop ${model.stopNumber - 1}
                    </span>

                    <span if.bind="model.stopNumber - 1 === template.stops.length" translate>
                        New stop at the end of the template
                    </span>

                    <span if.bind="model.stopNumber === 1" translate>
                        New stop at the beginning of the template
                    </span>

                </span>

                <path-nav if.bind="model.id">

                    <a accent="inherit" click.trigger="onCancel()" translate>
                        Stop ${model.stopNumber}
                    </a>

                    <div translate>
                        Edit
                    </div>

                </path-nav>

            </h1>

        </modal-header>

        <modal-section class="margin-bottom">

            <div class="control-row margin-larger-bottom">

                <select-input label="above" none.bind="false" value.bind="model.type" display-value.bind="model.type.name" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Type
                    </div>

                    <item repeat.for="type of types" model.bind="type">
                        ${type.name}
                    </item>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.type">
                        </required-validator>

                    </div>

                </select-input>

                <div class="control-row flex-basis-1-of-2">

                    <time-input label="above" value.bind="model.arrivalTimeFrame.from" class="flex-basis-1-of-2">

                        <div slot="heading" translate>
                            Arrival from
                        </div>

                        <div slot="validation">

                            <required-validator
                                value.bind="model.arrivalTimeFrame.from">
                            </required-validator>

                        </div>

                    </time-input>

                    <time-input label="above" value.bind="model.arrivalTimeFrame.to" class="flex-basis-1-of-2">

                        <div slot="heading" translate>
                            Arrival to
                        </div>

                        <div slot="validation">

                            <required-validator
                                value.bind="model.arrivalTimeFrame.to">
                            </required-validator>

                        </div>

                    </time-input>

                </div>

            </div>

            <hr class="hr-line margin-larger-bottom">

            <div class="control-row margin-large-bottom">

                <address-input label="above" value.bind="model.location.address" class="flex-basis-1-of-1">

                    <div slot="heading" translate>
                        Address
                    </div>

                    <div slot="validation">

                        <required-validator
                            value.bind="model.location.address">
                        </required-validator>

                    </div>

                </address-input>

            </div>

            <div class="control-row margin-large-bottom">

                <text-input label="above" value.bind="model.contact.fullName" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Full name
                    </div>

                </text-input>

                <text-input label="above" value.bind="model.contact.companyName" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Company
                    </div>

                </text-input>

            </div>

            <div class="control-row margin-large-bottom">

                <phone-input label="above" value.bind="model.contact.phoneNumber" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Phone number
                    </div>

                </phone-input>

                <email-input label="above" value.bind="model.contact.email" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Email
                    </div>

                </email-input>

            </div>

            <div class="control-row margin-large-bottom">

                <text-input label="above" value.bind="model.gate" class="flex-basis-1-of-1">

                    <div slot="heading" translate>
                        Gate
                    </div>

                </text-input>

            </div>

            <div class="control-row">

                <text-input label="above" lines.bind="3" value.bind="model.driverInstructions" class="flex-basis-1-of-1">

                    <div slot="heading" translate>
                        Driver instructions
                    </div>

                    <span slot="placeholder" translate>
                        Type any instructions that might help the driver
                    </span>

                </text-input>

            </div>

        </modal-section>

        <modal-section>

            <div slot="header" translate>
                Driver tasks
            </div>

            <div class="control-row margin-large-bottom">

                <check-toggle label="after" value.bind="model.requirements.photo" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Photo
                    </div>

                </check-toggle>

                <check-toggle label="after" value.bind="model.requirements.signature" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Signature
                    </div>

                </check-toggle>

            </div>

            <div class="control-row margin-large-bottom">

                <check-toggle label="after" value.bind="model.requirements.scanColli" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Scan colli
                    </div>

                </check-toggle>

                <check-toggle label="after" value.bind="model.requirements.verifyTimeframe" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Verify timeframe
                    </div>

                </check-toggle>

            </div>

            <div class="control-row">

                <check-toggle label="after" value.bind="model.requirements.customerCode" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Customer code
                    </div>

                </check-toggle>

                <check-toggle label="after" value.bind="model.requirements.acceptInstructions" class="flex-basis-1-of-2">

                    <div slot="heading" translate>
                        Accept instruction
                    </div>

                </check-toggle>

            </div>

        </modal-section>

        <button appearance="solid" accent="primary" class="margin-larger-top" click.delegate="onCreateClick()">
            <span translate if.bind="!model.id">
                Create stop
            </span>
            <span translate if.bind="model.id">
                Update stop
            </span>
        </button>

    </modal-panel>

</template>
