<template>

    <require from="app/components/info-icon/info-icon"></require>
    <require from="./select-columns.scss"></require>

    <modal-backdrop close="all"></modal-backdrop>

    <modal-panel name="select-columns" position="right" close-button.bind="true" close-shortcut.bind="true" scroll>

        <div slot="actions">

            <button
                appearance="icon"
                title.translate="Save changes"
                disabled.bind="!canSaveChanges"
                click.trigger="onSaveClick()">
                <icon name="save"></icon>
            </button>

        </div>

        <modal-header scroll-fade>

            <h1 class="font-largest margin-bottom" translate>
                Choose list columns}
            </h1>

            <div class="font-large">

                <span translate>
                    Here you can choose the columns to show in the list,
                    their order, and their width relative to each other
                </span>

                <info-icon position="left">
                    <div slot="body" translate>
                        For example, setting the width of two columns to 1 and 2,
                        or 50 and 100, would produce the same result;
                        one column will be twice as wide as the other.
                    </div>
                </info-icon>

            </div>

            <button
                if.bind="listViewType != null"
                appearance="none"
                accent="primary"
                class="margin-top"
                disabled.bind="!canSetAsDefault"
                click.trigger="onSetAsDefaultClick()"
                translate>
                Set as default for new views
            </button>

        </modal-header>

        <modal-section if.bind="true" class="margin-bottom">

            <data-table
                appearance="rows"
                selection="multiple"
                toggle-all.call="onToggleAllColumns(value)"
                move.call="onMoveColumn(source, target)">

                <data-table-headers>

                    <data-table-cell>
                        <span class="text-truncate" translate>
                            Column
                        </span>
                    </data-table-cell>

                    <data-table-cell>
                        <span class="text-truncate" translate>
                            Size
                        </span>
                    </data-table-cell>

                </data-table-headers>

                <data-table-row
                    repeat.for="columnInfo of columnInfos"
                    toggle.call="onToggleColumn(columnInfo.column, value)"
                    selected.bind="columnInfo.selected"
                    movable.bind="columnInfo.selected"
                    model.bind="columnInfo.column">

                    <data-table-cell>
                        <span class="text-truncate">
                            ${columnInfo.column.name}
                        </span>
                    </data-table-cell>

                    <data-table-cell class="select-columns-width-cell">
                        <select-input
                            if.bind="columnInfo.selected && columnInfo.column.visibility === 'visible'"
                            appearance="outline"
                            value.bind="columnInfo.column.width"
                            display-value.bind="columnInfo.column.width.replace('fr', '').replace('-content', '') | case: 'sentence'"
                            none.bind="false"
                            fixed.bind="true"
                            filter="auto"
                            change.trigger="onColumnWidthChange()">
                            <item model="auto">
                                Auto
                            </item>
                            <item model="min-content">
                                Min
                            </item>
                            <item model="max-content">
                                Max
                            </item>
                            <div>
                                <item repeat.for="i of 100" model="${i + 1}fr">
                                    ${i + 1}
                                </item>
                            </div>
                        </select-input>
                        <text-input
                            if.bind="columnInfo.selected && columnInfo.column.visibility === 'icon'"
                            appearance="outline"
                            value.bind="columnInfo.column.width"
                            value.translate="Icon"
                            disabled.bind="true"
                            inert>
                        </text-input>
                    </data-table-cell>

                </data-table-row>

            </data-table>

        </modal-section>

    </modal-panel>

</template>
