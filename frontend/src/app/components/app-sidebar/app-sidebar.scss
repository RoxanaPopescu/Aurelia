@import "resources/index";

app-sidebar
{
    // Allow content to be positioned relative to this element.
    position: relative;

    // Use vertical flex layout.
    display: flex;
    flex-direction: column;

    // Set the width of the sidebar.
    width: var(--app-sidebar-width);

    // Don't shrink - we collapse it manually in small viewports.
    flex-shrink: 0;

    // Apply the surface style.
    background: var(--surface-color);
    color: var(--surface-text-color);

    html:not(.platform-macos):not(.platform-ios) &::-webkit-scrollbar
    {
        // HACK: On platforms with ugly scrollbars, just hide it.
        display: none;
    }

    app-logo
    {
        z-index: 1;

        // Size and position the app logo.
        margin: 36rem 0 24rem 0;
        height: 28rem;

        // Center horizontally.
        align-self: center;

        // HACK: This assumes the dashboard is the only modal using the app-sidebar.
        modal-view & a:hover
        {
            // Prevent the hover effect from repeating when the dashboard
            // appears as a result of a click on the app-logo.
            transition: none;
        }
    }

    user-identity
    {
        // Size and position the user icon.
        margin: 16rem 0 20rem 0;
        width: auto;

        // Center horizontally.
        align-self: center;

        identity-picture
        {
            // Use surface color suitable for the app-sidebar.
            background: var(--surface-nav-link-surface-color--active);

            // Apply a border to ensure acceptable contrast.
            border: var(--border-width-thin) solid transparent;

            .identity-picture-surface
            {
                // Remove the filter that normally lightens the background color.
                filter: none;
            }
        }
    }

    &:not(.--expanded) user-identity .user-identity-text
    {
        display: none;
    }

    header,
    section,
    footer
    {
        // Use vertical flex layout.
        display: flex;
        flex-direction: column;

        // Don't shrink.
        flex-shrink: 0;
    }

    header
    {
        position: sticky;
        top: 0;
        z-index: 1;

        &::before
        {
            content: "";

            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: -8rem;

            // Apply the surface color to the header and footer,
            // so they cover any content scrolling under them.
            background-color: var(--surface-color);

            // Apply a mask to fade out the background.
            mask-image: linear-gradient(
                to bottom,
                #ffffff calc(100% - 40rem),
                rgba(#ffffff, 0.9) calc(100% - 16rem),
                rgba(#ffffff, 0) 100%
            );
        }
    }

    section
    {
        overflow-x: hidden !important;
        padding-top: 8rem;
        padding-bottom: 8rem;
    }

    footer
    {
        position: sticky;
        bottom: 0;

        // Push the footer to the bottom.
        margin-top: auto;

        z-index: 1;

        &::before
        {
            content: "";

            position: absolute;
            top: -8rem;
            left: 0;
            right: 0;
            bottom: 0;

            // Apply the surface color to the header and footer,
            // so they cover any content scrolling under them.
            background-color: var(--surface-color);

            // Apply a mask to fade out the background.
            mask-image: linear-gradient(
                to top,
                #ffffff calc(100% - 40rem),
                rgba(#ffffff, 0.9) calc(100% - 16rem),
                rgba(#ffffff, 0) 100%
            );
        }
    }

    .app-sidebar-shadow
    {
        // Position the shadow container so it sticks along the top edge.
        position: sticky;
        top: 0;
        width: 100%;

        div
        {
            // Position the shadow along the right edge.
            position: absolute;
            right: 0;

            // Set the size of the shadow.
            width: 16rem;
            height: 100vh;

            // Use a gradient to simulate a subtle shadow.
            background: linear-gradient(
                to left,
                rgba(0, 0, 0, 0.3) 0,
                rgba(0, 0, 0, 0.3) 1rem,
                rgba(0, 0, 0, 0.15) 1rem,
                rgba(0, 0, 0, 0.1) 1rem,
                rgba(0, 0, 0, 0.004) 12rem,
                rgba(0, 0, 0, 0) 1rem
            );

            // Ensure the shadow does not interfere with interaction.
            pointer-events: none;

            // Animate opacity changes.
            transition: opacity var(--animation-duration-short);

            // Set the opacity of the shadow.
            opacity: 0.3;

            // HACK: This assumes all modals that use the `app-sidebar` has the same surface color.
            modal-view &
            {
                // Reduce the opacity of the shadow while a modal overlay with
                // the same surface color, such as the `dashboard`, is open.
                opacity: 0.2;
            }
        }
    }

    .app-sidebar-powered-by
    {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 44rem;
        z-index: 1;
        margin-top: 1px;
        padding: 4rem;
        font-size: 9rem;
        line-height: 18rem;
        text-align: center;
        // background-color: var(--surface-nav-link-surface-color--hover);
        color: var(--surface-nav-child-link-surface-text-color);

        &:hover
        {
            color: var(--surface-nav-link-surface-text-color--hover);
        }

        span
        {
            opacity: 0.5;
        }
    }
}

.nav-link
{
    display: flex;
    align-items: center;
    align-self: stretch;

    // Position above the gradient background.
    z-index: 1;

    // Size and space other icons.
    padding: 12rem 26rem;

    // Animate the hover effect.
    transition: color var(--animation-duration-short);

    // Apply theme colors.

    color: var(--surface-nav-link-surface-text-color);
    background-color: var(--surface-nav-link-surface-color);
    border-color: var(--surface-nav-link-border-color);

    &:hover
    {
        color: var(--surface-nav-link-surface-text-color--hover);
        background-color: var(--surface-nav-link-surface-color--hover);
        border-color: var(--surface-nav-link-border-color--hover);

        > icon
        {
            color: var(--surface-nav-link-surface-icon-color--hover);
        }

        > span
        {
            color: var(--surface-nav-link-surface-text-color--hover);
        }
    }

    &.--active,
    &.--active-within
    {
        background-color: var(--surface-nav-link-surface-color--active);
        border-color: var(--surface-nav-link-border-color--active);
    }

    &.--active
    {
        color: var(--surface-nav-link-surface-text-color--active);
        font-weight: 600;

        > icon
        {
            color: var(--surface-nav-link-surface-icon-color--active);
        }

        > span
        {
            color: var(--surface-nav-link-surface-text-color--active);
        }
    }

    > icon
    {
        font-size: 24rem;
        color: var(--surface-nav-link-surface-icon-color);
    }

    > span
    {
        display: none;
        transition: opacity var(--animation-duration-short);
    }
}

.sidebar-child-link-container
{
    padding: 8rem 0;
    background: var(--surface-nav-child-surface-color);

    // Apply bottom border for increased contrast.
    //border-bottom: var(--border-width-thin) solid var(--surface-nav-link-border-color--active);
}

.sidebar-child-link
{
    display: flex;
    align-items: center;
    padding: 7rem 0 7rem 30rem;
    border-radius: var(--border-radius-small);

    opacity: 0.7;

    // Apply theme colors.

    color: var(--surface-nav-child-link-surface-text-color);
    background-color: var(--surface-nav-child-link-surface-color);
    border-color: var(--surface-nav-child-link-border-color);

    icon
    {
        font-size: 16rem;
        color: var(--surface-nav-child-link-surface-icon-color);
        margin-right: 16rem;
    }

    &:hover
    {
        color: var(--surface-nav-child-link-surface-text-color--hover);
        background-color: var(--surface-nav-child-link-surface-color--hover);
        border-color: var(--surface-nav-child-link-border-color--hover);

        > icon
        {
            color: var(--surface-nav-child-link-surface-icon-color--hover);
        }

        > span
        {
            color: var(--surface-nav-child-link-surface-text-color--hover);
        }
    }

    &.--active
    {
        font-weight: 600;

        opacity: 1;

        color: var(--surface-nav-child-link-surface-text-color--active);
        background-color: var(--surface-nav-child-link-surface-color--active);
        border-color: var(--surface-nav-child-link-border-color--active);

        > icon
        {
            color: var(--surface-nav-child-link-surface-icon-color--active);
        }

        > span
        {
            color: var(--surface-nav-child-link-surface-text-color--active);
        }
    }
}

app-sidebar.--expanded
{
    // Set the width of the sidebar.
    width: var(--app-sidebar-width-expanded);

    app-logo
    {
        // Align horizontally with the links.
        align-self: stretch;
        margin-left: 28rem;
        margin-right: 26rem;
    }

    user-identity
    {
        // Align horizontally with the links.
        align-self: stretch;
        margin-left: 24rem;
        margin-right: 26rem;

        color: var(--surface-nav-child-link-surface-text-color);

        &:hover
        {
            color: var(--surface-nav-link-surface-text-color--hover);
        }
    }

    .nav-link
    {
        > span
        {
            display: block;
            margin-left: var(--size-inline-spacing-large);
        }
    }

    .sidebar-child-link-container
    {
        padding: 20rem 18rem;
    }

    .sidebar-child-link
    {
        padding: 7rem 4rem 7rem 12rem;
    }

    .app-sidebar-powered-by
    {
        justify-content: flex-start;
        padding-left: 27rem;
        line-height: 26rem;
        font-size: 11rem;
        text-align: left;
        white-space: nowrap;

        br
        {
            display: none;
        }
    }
}
